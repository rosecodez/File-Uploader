<ul class="flex flex-col gap-4">
    <% folders.forEach(folder => { %>
        <li class="flex flex-row gap-2 items-end justify-between">
            <div id="folders-left-side" class="flex flex-row gap-2 items-center">
                <img src="/images/icons8-folder-50.png" class="w-7 self-start" alt="Folder">
                <a href="/drive/folders/<%= folder.id %>" class="text-blue-600 hover:underline underline-offset-4 decoration-2 hover:underline decoration-violet-500">
                    <%= folder.name %>
                </a>    
            </div>

            <div id="folders-right-side" class="flex gap-4 items-center">
                <a href="/drive/folders/<%= folder.id %>/rename">
                    <button>Rename</button>
                </a>
                <button onclick="showDeleteModal('folder', '<%= folder.id %>', '<%= folder.name %>')">Delete</button>
            </div>
        </li>
    <% }) %>

    <% files.forEach(file => { %>
        <li class="flex flex-row gap-2 items-end justify-between">
            <div id="files-left-side" class="flex flex-row gap-2 items-center">
                <img src="/images/icons8-file-50.png" class="w-7 self-start" alt="File"/>
                <a href="/drive/files/<%= file.id %>" class="text-blue-600 hover:underline underline-offset-4 decoration-2 hover:underline decoration-violet-500">
                    <%= file.name %>
                </a>    
            </div>

            <div id="files-right-side" class="flex gap-4 items-center">
                <a href="/drive/files/<%= file.id %>/rename">
                    <button>Rename</button>
                </a>
                
                <button onclick="showDeleteModal('file', '<%= file.id %>', '<%= file.name %>')">Delete</button>
            </div>
        </li>
    <% }) %>
</ul>

<div id="deleteModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex justify-center items-center hidden">
    <div class="bg-white p-8 rounded shadow-lg max-w-xs w-full">
        <h2 class="text-lg font-bold mb-4">Delete Confirmation</h2>
        <p id="deleteMessage" class="mb-6">Are you sure you want to delete this item?</p>
        <form id="deleteForm" method="POST" action="">
            <div class="flex justify-between">
                <button type="button" class="px-4 py-2 bg-gray-400 text-white rounded" onclick="hideDeleteModal()">Cancel</button>
                <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded">Delete</button>
            </div>
        </form>
    </div>
</div>

<script>
    function showDeleteModal(itemType, itemId, itemName) {
        const deleteModal = document.getElementById('deleteModal');
        const deleteMessage = document.getElementById('deleteMessage');
        const deleteForm = document.getElementById('deleteForm');

        deleteMessage.textContent = `Are you sure you want to delete "${itemName}"?`;

        deleteForm.action = itemType === 'folder' ? `/drive/folders/${itemId}/delete` : `/drive/files/${itemId}/delete`;

        deleteModal.classList.remove('hidden');
    }


    function hideDeleteModal() {
        const deleteModal = document.getElementById('deleteModal');
        deleteModal.classList.add('hidden');
    }
</script>
